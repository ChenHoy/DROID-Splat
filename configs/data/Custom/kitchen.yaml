dataset: "folder"
mode: $mode
stride: 1
mapping:
  device: "cuda:0"
  bound: [[-5.0, 5.0], [-5.0, 5.0], [-5.0, 5.0]]

# NOTE chen: The kitchen scene can only be reconstructed together with a prior
# it works decently when you just use the frontend with these settings
# Using the backend is crucial for consistency and a good global structure, HOWEVER 
# this needs to be used only scarcily in order to not disturb the frontend
tracking:
  device: "cuda:0"
  buffer: 1024
  beta: 0.3
  warmup: 7
  upsample: True
  motion_filter:
    thresh: 4.0  # add as keyframe if avg flow >= 4.0 pixels
  multiview_filter:
    thresh: 0.01  # depth error < 0.01m
    visible_num: 2  # points viewed by at least 2 cameras
    kernel_size: inf
    bound_enlarge_scale: 1.20
  frontend:
    thresh: 15.0 
    radius: 4
    window: 40
    nms: 0
    enable_loop: False
  backend:
    do_loop_closure: True
    warmup: 10
    thresh: 25.0  
    radius: 5
    window: 200 # Limit backend in case we would run OOM
    nms: 0
    # used for loop detection
    loop_window: 200
    loop_thresh: 20.0  
    loop_radius: 4
    loop_nms: 2

cam:
  ### original camera parameters
  H: 1920
  W: 1080
  ### target/output camera settings, camera_size -> resize -> crop -> target_size
  H_out: 540
  W_out: 960
  H_edge: 0 # NOTE I think this is just padding
  W_edge: 0
  fx: 1296.0
  fy: 1296.0
  cx: 540
  cy: 960
  calibration_txt: ''

rendering:
  N_samples: 24
  N_surface: 48

meshing:
  eval_rec: True
  resolution: 512  # change to 512 for higher resolution geometry
  get_largest_components: False
  remove_small_geometry_threshold: 0.2
  n_points_to_eval: 200000
  mesh_threshold_to_eval: 0.05
  forecast_radius: 25

data:
  input_folder: /media/data/ours/kitchen/raw/images
  output: ""